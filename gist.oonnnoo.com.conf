server {
  include              /usr/local/nginx/conf.d/common/listen-withssl;
  server_name          gist.oonnnoo.com;
  include              /usr/local/nginx/conf.d/common/oonnnoo-com-sslcert;
  include              /usr/local/nginx/conf.d/common/acme-challenge;
  access_log           /usr/local/nginx/logs/gist_oonnnoo_com_access.log;
  error_log            /usr/local/nginx/logs/gist_oonnnoo_com_error.log;

  location / {
    root        /var/www/oonnnoo/gist;
    index       index.html index.htm index.php;
    add_header  Strict-Transport-Security "max-age=31536000; includeSubDomains; preload";
  }
  location /oonnnoo/ {
    proxy_pass https://gist.github.com/oonnnoo/;
    proxy_set_header Host gist.github.com;
    proxy_connect_timeout 3s;
    error_page 500 502 504 @redirectdocker;
  }
  location @redirectgist {
    rewrite ^/(.*)$ https://gist.github.com/$1 redirect;
  }
}
